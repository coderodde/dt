#!/bin/bash

cd

if [ ! -d ".dt" ]; then
  mkdir .dt
fi

cd .dt
touch table

TABLE_CONTENT="home $HOME"
MAIN_SCRIPT="if [ \$# -ne 1Â ]; then\n  echo \"usage: dt TAG\"\n  exit 1\nfi\nTARGET=\$(./~/.dt/dt_engine \$1)\n. \$TARGET"
ALIAS_MAGIC="# The following alias is created by dt (Directory tagger).\nalias dt=\". ~/.dt/dt_script\""

grep -i "home" table
ret=$?

if [ $ret == 0 ]; then
  echo "Initial tag already in the table."
else
  echo "Initial tag not found; appending."
  echo "$TABLE_CONTENT" >> table
fi

echo -e $MAIN_SCRIPT > dt_script
echo -e $ALIAS_MAGIC >> ~/.bashrc

